[workspace]
name = "sceneweaver"
description = "A tool for creating videos from YAML specification files"
authors = ["SceneWeaver Team"]
channels = ["conda-forge"]
platforms = ["linux-64", "win-64", "osx-64", "osx-arm64"]

[dependencies]
python = ">=3.8"
pyyaml = ">=6.0"
platformdirs = ">=4.5.0,<5"
scipy = "*"
python-sounddevice = "*"

[pypi-dependencies]
sceneweaver = { editable = true, path = "." }
build = "*"

[feature.dev.dependencies]
pytest = ">=7.0"
pytest-cov = ">=4.0"
black = ">=22.0"
flake8 = "*"
pyflakes = "*"
pyright = "*"
ruff = "*"
pre-commit = "*"

[feature.build.dependencies]
setuptools = ">=61.0"
wheel = "*"
setuptools-scm = ">=6.2"

[environments]
default = ["dev"]
build = ["build"]

[tasks]
lint = { depends-on = ["flake", "pyflakes", "pyright"] }
format = "ruff format sceneweaver tests"
sceneweaver = "python -m sceneweaver"

[tasks.test]
cmd = "pytest -v"
depends-on = ["clean"]

[tasks.clean]
description = "Remove build artifacts and caches."
cmd = [
    "rm", "-rf",
    "dist",
    "build",
    ".ruff_cache",
    ".pytest_cache",
    ".pyright_cache",
    '"**/*/__pycache__"',
    '"*.egg-info"',
    "sceneweaver/_version.py",
]

[tasks.flake]
cmd = "flake8 --ignore=E127,E128,E121,E123,E126,E203,E226,E24,E704,W503,W504 --builtins=_ sceneweaver tests"

[tasks.pyflakes]
cmd = "pyflakes sceneweaver tests"
env = { PYFLAKES_BUILTINS = "_" }

[tasks.pyright]
cmd = "pyright"

[tasks.wheel]
description = "Build the project wheel"
cmd = "python -m build --wheel --outdir dist"
depends-on = ["clean"]
